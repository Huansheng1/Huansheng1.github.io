# 微前端入门
> [Thinking in Microfrontend (微前端的那些事儿)](https://microfrontends.cn/)
> [深入调研了微前端，还是iframe最香](https://juejin.cn/post/7244070072788287544?searchId=20240424173657D99FFB1594D9B5987213#heading-25)
## 技术选型
### 实现方式
1. `Iframe`：通过`iframe`标签作为容器引入其他页面，通过`postMessage`进行页面之间的传参

> 优势：

* 技术成熟，是原生就支持的技术
* 支持页面嵌入
* 天然支持运行沙箱隔离，页面独立运行

> 劣势：

* 页面之间如果是不同域名存在跨域等一系列问题
* 需要额外设计一套应用通讯机制来决定如何进行消息的监听与传递等
* 应用加载、渲染、缓存等体系完全由浏览器决定，我们难以手动处理控制

2. `web component`：`Html5`的一项新技术，原生支持自定义标签的方式来定义个标准的组件

> 优势：

* 支持自定义标签元素、`shadow dom`，控制起来比较灵活

* 支持模板`temlapate`和插槽`slot`，方便的引入自定义组件内容  

> 劣势：

* 由于`web component`是原生技术，类似于框架里的组件，将部分逻辑与业务封装起来再进行引用，因此需要对老项目进行通过`web component`的方式重写，改动大，侵入性强

* 规范出来时间较短，生态不完善，容易出现需要自己大量实现且兼容性问题不容忽视

* 偏向组件的形式导致通讯起来可能比较繁琐复杂

3. 自研框架/第三方框架

> 优势：

* 高度定制化，完全由自己做主，兼容性自己控制有保证

* 独立的通讯机制和沙箱运行环境，可以保证应用之间相互影响的问题

* 支持不同技术栈子应用，可以无缝实现页面刷新渲染

> 劣势：

* 技术实现难度较高

* 需要设计一套定制的通信机制

* 首次加载可能会出现资源过大的情况

## 自研框架准备
### 需求/功能点

1. 分发式路由

2. 主应用控制路由匹配和子应用加载，共享依赖加载

3. 子应用做功能，与主应用实现控制与联动

### 技术栈

应用：

* 主应用：`vue3`

* 子应用：`vue3`、`react`、`angular`

* 后端服务和发布应用：`koa`

### 实现思路

![](https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20220123170702.png)
![](https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20220123170738.png)

![](https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20220123171515.png)