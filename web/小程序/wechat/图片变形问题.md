# 图片变形问题
## 场景
在页面刚渲染，加载列表，加载一系列图片时，`wxml`自带的静态图片在网络图片显示前显示会表现出相应的变形，大约`100ms-300ms`

## 分析过程
刚开始，揣测是网络未请求之前先显示，可显示区域过大导致的图片样式变形

因此，解决方法是通过设置`hidden`属性，在网络请求未完成之前，不显示静态图片，从而避免图片的变形现象产生；

表面上，这确实解决了问题，但是，在疯狂刷新渲染页面测试时，还是偶尔会出现图片变形拉长的现象；

且该做法需要在页面内的`image`显示时统统加上`hidden`属性来判断什么时候显示，极其繁琐且低级，而且，实际上并没有解决我们该问题。

## 转机
通过查阅资料，我对该现象有了更深的认识（如有错误，欢迎纠正！）。

首先，引起该现象的原因为：我们给图片设置了`mode`属性，该属性用于设置图片缩放模式，具体可查看[官方文档](https://developers.weixin.qq.com/miniprogram/dev/component/image.html)

> 常用的几个属性：
* `aspectFit`：	缩放模式，保持纵横比缩放图片，使图片的长边能完全显示出来。也就是说，可以完整地将图片显示出来。
* `widthFix`：	缩放模式，宽度不变，高度自动变化，保持原图宽高比不变	
* `heightFix`：	缩放模式，高度不变，宽度自动变化，保持原图宽高比不变

触发时的代码使用的是`widthFix`模式，通过设置宽度，自动根据图片比例产生对应的自适应高度从而达到良好的显示效果。

但是，当当前页面渲染大量数据时，会导致自适应计算是有一个耗时时间的，而 
* `image组件默认宽度320px、高度240px`

因此，当前页面渲染过程我推测是这样的：
1. 页面内的图片先显示默认高度 `320px`
2. 然后根据宽度自动计算出合适的高度再修改图片的高度
3. 而这两者直接有一定耗时，从而使得页面在刚进入渲染时表现出一个拉长闪烁的现象

因此，为了良好的用户体验，我们应该如此解决：

在 `app.wxss`内增加代码：
```css
image{
  height:0;
  max-height:1080px;
}
```
* 覆盖默认`320px`高度样式，避免页面刚进入时的拉伸现象，`widthFix`模式计算出高度后便会自动进行对应的高度设置！

## 其他
* [图片加载方式探究](图片加载方式探究.md)