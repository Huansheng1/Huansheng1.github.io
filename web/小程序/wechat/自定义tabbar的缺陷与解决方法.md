# 小程序自定义`TabBar`导航栏
> 有时候为了实现美工设计的`UI`图，我们使用系统自带的`tabBar`难免力不从心，无法达到要求。

> 比如，星巴克小程序.
## 自定义导航栏
这时候，我们如果按照官方文档中的方式，通过自定义导航栏来完成的话，看起来是符合预期的！

可实际上，自定义导航栏（`2020-10-20号以前`）是有很多坑没有解决的：
1. 自定义导航栏在安卓手机上会跟随整个页面下拉刷新动作而滚到屏幕下方不可见区域，也就是说：在目前安卓微信上无法保持绝对固定
2. 部分页面上即使通过`position:fixed`固定在了最下方，在切换页面渲染时依旧会在屏幕上方地区闪一下才回归正常界面（在模拟器较卡预览界面比较明显）
3. 小程序启动时只会加载默认图标，那些活跃时才展现的图标存在一定加载时间，这也说明：切换`tabBar`时`activedIcon`会先空白再从网络加载出来，体验有点糟糕
4. `tabBar`页面第一次切换时 ，底部`tabBar`会重新渲染初始化，因此，在`custom-tab-bar`组件里用变量记录当前选中状态是不靠谱的！
> 真要使用自定义`tabbar`，推荐在`tabBar`相关页面的`onShow`事件里通过`this.getTabbar()`方法获取`自定义tabBar`实例，再往其中写入当前页面序号，然后`custom-tab-bar`组件里就可以根据页面写入的`selected`变量值进行动态刷新了。
```js
// tabbar页面往自定义tabbar实例里设置自身页面序号
setTabBarIndex(){
    if (typeof this.getTabBar === 'function' && this.getTabBar()) {
      this.getTabBar().setData({
        selected: 0  //数字是当前页面在tabbar的索引,如我的查询页索引是2，因此这边为2，同理首页就为0，审批页面为1
      })
    }
  }
```
```js
// 自定义tabbar实例里在刚载入dom树时（也就是初次切换tabbar页面会莫名其妙重新渲染时）对变量重新设置合适的值
// 不过感觉应该没必要，因为，tabbar页面里通过setData应该就能直接改变对应的值，不过如果生效的话，可试试这样写
attached() {
    this.setData({
      selected: this.getTabBar().data.selected,
    });
  },
```

最后，其实通过存储在`sessionStorage`再使用上面方法在渲染时从存储数据里读取，就可以只在`tabBar`页面实现了，而不需要更改其他页面代码。
## 另类实现思路
既然上面的提到 自定义导航栏 有那么多缺点，那我们如何实现一个较完美的 导航栏呢？
> 注意：跟随下拉刷新而整体往下滚动的问题在这个方案里也无法解决

思路：
* 其实很简单，既然自定义导航栏问题这么多的话，我们何不只写一个页面，页面里写个`tabBar`样式，通过点击不同`tabBar`切换上方显示不同内容不就完事了？
* 总结：一个页面通过`假的tabBar`切换显示上方内容（`组件`或者`模板template`）即可达到视觉上的自定义导航栏效果

## 总结
自定义导航栏 是多页面切换，而 另类组件切换方式 其实更偏向于 单页面富应用
